name: Build and Deploy Strapi App

on:
  push:
    branches:
      - production  

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3
      with:
        fetch-depth: 0

    # - name: Set up Node.js
    #   uses: actions/setup-node@v3
    #   with:
    #     node-version: 19 

    # - name: Install Dependencies
    #   run: npm install

    - name: Pull in env
      run: mv .env.example .env

    # - name: Build Strapi App for Production
    #   run: NODE_ENV=production npm run build  

    - name: Sync Files
      uses: milanmk/actions-file-deployer@master
      with:
        remote-protocol: "ftp"
        remote-port: ${{ secrets.FTP_PORT }}
        remote-host: ${{ secrets.FTP_SERVER }}
        remote-user: ${{ secrets.FTP_USERNAME }}
        remote-password: ${{ secrets.FTP_PASSWORD }} 
        remote-path: "/strapi"  